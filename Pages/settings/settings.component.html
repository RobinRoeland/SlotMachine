
<div class="settings-container">
     <!-- Saved Indicator -->
    <div class="settings-actions">
    <span class="saved-indicator" [class.visible]="showSaved">
        ‚úì Settings saved
    </span>
    </div>

    <!-- General Settings Section -->
    <app-settings-section
    title="General Settings"
    description="Configure the general appearance and branding of the application."
    >
    <!-- Color Theme Subsection -->
    <div class="subsection">
        <h3 class="subsection-title">Color Theme</h3>
        <p class="subsection-description">Choose the color theme for the application.</p>
        <div class="theme-settings">
        <p class="helper-text">Select a color theme to change the appearance of the application.</p>
        
        <!-- Theme Options Grid -->
        <div class="theme-grid">
        <div 
            *ngFor="let theme of availableThemes"
            class="theme-option"
            [class.selected]="isThemeSelected(theme.name)"
            (click)="selectTheme(theme.name)"
        >
            <div class="theme-preview" [style.background]="theme.colors.previewGradient"></div>
            <div class="theme-name">{{ theme.displayName }}</div>
            <div class="selected-indicator">‚úì</div>
        </div>
        </div>
        </div>
    </div>

    <hr class="subsection-divider" />

    <!-- Company Branding Subsection -->
    <div class="subsection">
        <h3 class="subsection-title">Company Branding</h3>
        <p class="subsection-description">Customize the company logo displayed throughout the application.</p>
        <div class="logo-settings">
        <!-- Logo Type Toggle -->
        <div class="logo-type-toggle">
        <button 
            class="toggle-btn"
            [class.active]="selectedLogoType === 'regular'"
            (click)="switchLogoType('regular')"
        >
            üìÑ Regular Logo
        </button>
        <button 
            class="toggle-btn"
            [class.active]="selectedLogoType === 'small'"
            (click)="switchLogoType('small')"
        >
            üîò Small Logo
        </button>
        </div>

        <!-- Regular Logo Section -->
        <div *ngIf="selectedLogoType === 'regular'" class="logo-content">
        <p class="logo-usage-hint">This logo is displayed in the sidebar header (inside the expanded sidebar)</p>
        <!-- Current Logo Preview -->
        <div class="logo-preview-section">
        <h4>Current Logo</h4>
        <div class="logo-preview">
            <img [src]="settings.companyLogo" alt="Company Logo" />
        </div>
        </div>

        <!-- Logo Path Input -->
        <div class="logo-input-section">
        <h4>Logo Path</h4>
        <input 
            type="text" 
            class="logo-path-input"
            [value]="settings.companyLogo"
            (change)="onLogoPathChange($any($event.target).value)"
            placeholder="assets/images/your-logo.png"
        />
        <p class="helper-text">Enter the path to your logo file, or upload/select one below.</p>
        </div>

        <!-- File Upload -->
        <div class="logo-upload-section">
        <h4>Upload Custom Logo</h4>
        <label class="upload-button">
            <input 
            type="file" 
            accept="image/*"
            (change)="onLogoFileUpload($event)"
            hidden
            />
            <span>üìÅ Choose File</span>
        </label>
        <p class="helper-text">Upload a custom logo image (PNG, JPG, SVG, etc.)</p>
        </div>

        <!-- Preset Logos -->
        <div class="logo-presets-section">
        <h4>Or Select a Preset</h4>
        <div class="logo-grid">
            <div 
            *ngFor="let logo of presetLogos"
            class="logo-option"
            [class.selected]="isLogoSelected(logo)"
            (click)="selectPresetLogo(logo)"
            >
            <img [src]="logo" [alt]="logo" />
            <div class="selected-indicator">‚úì</div>
            </div>
        </div>
        </div>
        </div>

        <!-- Small Logo Section -->
        <div *ngIf="selectedLogoType === 'small'" class="logo-content">
        <p class="logo-usage-hint">This logo is displayed in the collapse/expand toggle button (top-left corner)</p>
        <!-- Current Small Logo Preview -->
        <div class="logo-preview-section">
        <h4>Current Small Logo</h4>
        <div class="logo-preview logo-preview-small">
            <img [src]="settings.companyLogoSmall" alt="Company Small Logo" />
        </div>
        </div>

        <!-- Small Logo Path Input -->
        <div class="logo-input-section">
        <h4>Small Logo Path</h4>
        <input 
            type="text" 
            class="logo-path-input"
            [value]="settings.companyLogoSmall"
            (change)="onLogoSmallPathChange($any($event.target).value)"
            placeholder="assets/images/your-small-logo.png"
        />
        <p class="helper-text">Enter the path to your small logo file, or upload/select one below.</p>
        </div>

        <!-- Small Logo File Upload -->
        <div class="logo-upload-section">
        <h4>Upload Custom Small Logo</h4>
        <label class="upload-button">
            <input 
            type="file" 
            accept="image/*"
            (change)="onLogoSmallFileUpload($event)"
            hidden
            />
            <span>üìÅ Choose File</span>
        </label>
        <p class="helper-text">Upload a custom small logo image (PNG, JPG, SVG, etc.)</p>
        </div>

        <!-- Preset Small Logos -->
        <div class="logo-presets-section">
        <h4>Or Select a Preset</h4>
        <div class="logo-grid">
            <div 
            *ngFor="let logo of presetLogosSmall"
            class="logo-option"
            [class.selected]="isLogoSmallSelected(logo)"
            (click)="selectPresetLogoSmall(logo)"
            >
            <img [src]="logo" [alt]="logo" />
            <div class="selected-indicator">‚úì</div>
            </div>
        </div>
        </div>
        </div>
        </div>
    </div>
    </app-settings-section>

    <!-- Game-Specific Settings (only shown when in game context) -->
    <ng-container *ngIf="shouldShowGameSettings() && gamesService.getCurrentGame() as currentGame">
    <app-settings-section
        [title]="currentGame.name + ' Settings'"
        [description]="'Configure settings specific to ' + currentGame.name + '.'">
        
        <!-- Group settings by their group property -->
        <ng-container *ngFor="let group of getGameSettingsGroups(currentGame)">
        <div class="game-settings-group" *ngIf="group">
            <h3 class="group-title">{{ group }}</h3>
            
            <ng-container *ngFor="let setting of getGameSettingsByGroup(currentGame, group)">
            <!-- Toggle Setting -->
            <app-setting-item
                *ngIf="setting.type === 'toggle'"
                [title]="setting.label"
                [description]="setting.description"
                [class.disabled]="isMobile && setting.id === 'prize-machine-enable-arduino'">
                <app-toggle-switch
                [checked]="getSettingValue(setting.id)"
                [disabled]="isMobile && setting.id === 'prize-machine-enable-arduino'"
                (checkedChange)="onGameSettingChange(setting.id, $event)">
                </app-toggle-switch>
            </app-setting-item>

            <!-- Text Input Setting -->
            <div *ngIf="setting.type === 'text'" class="button-text-settings">
                <div class="text-input-group">
                <label [for]="setting.id">{{ setting.label }}</label>
                <input 
                    type="text" 
                    [id]="setting.id"
                    class="text-input"
                    [value]="getSettingValue(setting.id)"
                    (blur)="onGameSettingChange(setting.id, $any($event.target).value)"
                    [placeholder]="setting.value"
                />
                <p class="input-hint">{{ setting.description }}</p>
                </div>
            </div>
            </ng-container>

            <!-- Arduino disabled note -->
            <div *ngIf="group === 'Arduino Control' && isMobile" class="arduino-disabled-note">
                ‚ö† Arduino control is not available on mobile devices
            </div>
        </div>
        <hr class="group-divider" *ngIf="!isLastGroup(currentGame, group)" />
        </ng-container>
    </app-settings-section> <!-- Close game settings section -->
    </ng-container> <!-- Close ngIf shouldShowGameSettings -->

    <!-- Data Management Section -->
    <app-settings-section
    title="Data Management"
    description="Export or import all application data including items, odds, prizes, and settings."
    >
    <div class="data-management-settings">
        <p class="helper-text">Use these options to backup or restore your complete slot machine configuration.</p>
        
        <div class="data-actions">
        <div class="action-item">
            <h4>Export All Data</h4>
            <p class="action-description">Download a complete backup of all items, odds, prizes, and settings to a JSON file.</p>
            <button class="export-button" (click)="exportAllData()">
            üì• Export All Data
            </button>
        </div>

        <div class="action-item">
            <h4>Import All Data</h4>
            <p class="action-description">Restore a complete backup from a JSON file. This will replace all current data.</p>
            <button class="import-button" (click)="importAllData()">
            üì§ Import All Data
            </button>
        </div>
        </div>

        <div class="data-warning">
        ‚ö†Ô∏è <strong>Warning:</strong> Importing data will completely replace your current items, odds, prizes, and settings. Make sure to export your current data first if you want to keep it.
        </div>
    </div>
    </app-settings-section>

    <!-- Tutorial Section (only shown when in game context and tutorial exists) -->
    <app-settings-section
    *ngIf="shouldShowGameSettings() && hasTutorial() && gamesService.getCurrentGame() as currentGame"
    title="Help & Tutorial"
    [description]="'Access the interactive tutorial to learn how to use ' + currentGame.name + '.'">
    <app-setting-item
        [title]="'Show ' + currentGame.name + ' Tutorial'"
        [description]="'Reopen the getting started tutorial that guides you through ' + currentGame.name + '.'">
        <button class="tutorial-button" (click)="showTutorial()">
        üìö Start Tutorial
        </button>
    </app-setting-item>
    </app-settings-section>
</div>